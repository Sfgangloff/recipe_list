{"ast":null,"code":"import _regeneratorRuntime from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{db}from\"./firebase.config\";import{relativeTimeRounding}from'moment';import React,{Component,createRef}from'react';import{collection,doc,addDoc,getDoc,setDoc,updateDoc,deleteDoc}from\"firebase/firestore\";import{v4}from'uuid';import Comment from'./editable.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommentList=/*#__PURE__*/function(_Component){_inherits(CommentList,_Component);var _super=_createSuper(CommentList);function CommentList(props){var _this;_classCallCheck(this,CommentList);_this=_super.call(this,props);_this.addComment=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(text){var x,timestamp,comments;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:x=v4();timestamp=Date.now();comments=_this.state.comments;comments.push({id:x,recipeId:_this.state.recipeId,text:text,timestamp:timestamp});comments.sort(function(a,b){return a.timestamp<b.timestamp?-1:1;});_this.setState({comments:comments});_context.next=8;return setDoc(doc(db,\"comments\",x),{recipeId:_this.state.recipeId,text:text,timestamp:timestamp});case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.removeComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){var comments,i;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:comments=_this.state.comments;for(i=0;i<comments.length;i++){if(comments[i].id===id){comments.splice(i,1);}console.log(comments);}comments.sort(function(a,b){return a.timestamp<b.timestamp?-1:1;});_context2.next=5;return deleteDoc(doc(db,\"comments\",id));case 5:_this.setState({comments:comments});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.state={recipeId:_this.props.recipeId,comments:_this.props.comments};_this.addComment=_this.addComment.bind(_assertThisInitialized(_this));_this.removeComment=_this.removeComment.bind(_assertThisInitialized(_this));return _this;}_createClass(CommentList,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsx(\"ol\",{children:this.state.comments.sort(function(a,b){return a.timestamp<b.timestamp?-1:1;}).map(function(comment,i){return/*#__PURE__*/_jsxs(\"li\",{children:[\" \",comment.recipeId===_this2.state.recipeId?/*#__PURE__*/_jsx(Comment,{id:comment.id,text:comment.text,recipeId:comment.recipeId,addComment:_this2.addComment,removeComment:_this2.removeComment}):/*#__PURE__*/_jsx(\"div\",{}),\" \"]},i);})});}}]);return CommentList;}(Component);export default CommentList;","map":{"version":3,"names":["db","relativeTimeRounding","React","Component","createRef","collection","doc","addDoc","getDoc","setDoc","updateDoc","deleteDoc","v4","Comment","CommentList","props","addComment","text","x","timestamp","Date","now","comments","state","push","id","recipeId","sort","a","b","setState","removeComment","i","length","splice","console","log","bind","map","comment"],"sources":["/home/silvere/Desktop/Apps/recipelist/src/editablelist.js"],"sourcesContent":["import { db } from \"./firebase.config\"\nimport { relativeTimeRounding } from 'moment';\nimport React, { Component, createRef } from 'react';\nimport {collection, doc, addDoc, getDoc, setDoc, updateDoc, deleteDoc} from \"firebase/firestore\"\nimport { v4 } from 'uuid';\n\nimport Comment from './editable.js';\n\nclass CommentList extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n        recipeId:this.props.recipeId,\n        comments:this.props.comments\n      }\n\n\n    this.addComment = this.addComment.bind(this)\n    this.removeComment = this.removeComment.bind(this)\n  \n}\n\n\naddComment= async (text) => {\n  var x = v4();\n  const timestamp = Date.now()\n  const comments = this.state.comments\n  comments.push({id:x,recipeId:this.state.recipeId,text:text,timestamp:timestamp})\n  comments.sort((a, b) =>\n      a.timestamp < b.timestamp ? -1 : 1,\n      )\n  this.setState({comments:comments})\n  await setDoc(doc(db, \"comments\", x),{recipeId:this.state.recipeId,text:text,timestamp:timestamp})\n  \n}\n\nremoveComment = async (id) => {\n  const comments = this.state.comments\n  for(var i = 0; i < comments.length; i++){ \n    \n    if ( comments[i].id === id) { \n\n        comments.splice(i, 1)\n        \n    }\n    console.log(comments)\n  }\n  comments.sort((a, b) =>\n      a.timestamp < b.timestamp ? -1 : 1,\n      )\n    await deleteDoc(doc(db,\"comments\",id))\n    this.setState({comments:comments})\n  }\n\n\n\n  render() {\n     return  <ol>{this.state.comments.sort((a, b) =>\n      a.timestamp < b.timestamp ? -1 : 1,\n      ).map((comment,i) => (\n               <li key={i}> {(comment.recipeId === this.state.recipeId) ? \n               <Comment id={comment.id} \n                        text={comment.text} \n                        recipeId={comment.recipeId} \n                        addComment={this.addComment} \n                        removeComment={this.removeComment}/>   : <div></div>} </li>\n                     ))}\n           </ol>\n    \n  }\n}\n\nexport default CommentList;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}