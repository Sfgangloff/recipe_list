{"ast":null,"code":"import _regeneratorRuntime from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/silvere/Desktop/Apps/recipelist/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{db}from\"./firebase.config\";import{relativeTimeRounding}from'moment';import React,{Component,createRef}from'react';import{collection,doc,addDoc,getDoc,setDoc,updateDoc,deleteDoc}from\"firebase/firestore\";import{v4}from'uuid';import{jsx as _jsx}from\"react/jsx-runtime\";var Comment=/*#__PURE__*/function(_Component){_inherits(Comment,_Component);var _super=_createSuper(Comment);function Comment(props){var _this;_classCallCheck(this,Comment);_this=_super.call(this,props);_this.updateComponentValue=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var commentsCollectionRef,commentRef,initialValue,newValue;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:commentsCollectionRef=collection(db,\"comments\");commentRef=doc(db,\"comments\",_this.state.id);initialValue=_this.state.text;//const newValue = this.refs.theTextInput.value\nnewValue=_this.selfRef.current.value;if(!(e.key===\"Enter\")){_context.next=17;break;}if(!(initialValue===\"############################################################\")){_context.next=9;break;}if(newValue!==initialValue&&newValue!==\"\"){_this.state.addComment(newValue);//var x = v4();\n//const timestamp = Date.now()\n//await setDoc(doc(db, \"comments\", x),{recipeId:this.state.recipeId,text:newValue,timestamp:timestamp})\n}_context.next=16;break;case 9:if(!(newValue!==\"\")){_context.next=15;break;}_this.setState({text:newValue});_context.next=13;return updateDoc(doc(db,\"comments\",_this.state.id),{text:newValue});case 13:_context.next=16;break;case 15:_this.state.removeComment(_this.state.id);//await deleteDoc(doc(db,\"comments\",this.state.id))\ncase 16:_this.setState({isInEditMode:false});case 17:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.state={id:_this.props.id,text:_this.props.text,recipeId:_this.props.recipeId,isInEditMode:false,addComment:_this.props.addComment,removeComment:_this.props.removeComment};_this.selfRef=/*#__PURE__*/React.createRef();_this.changeEditMode=_this.changeEditMode.bind(_assertThisInitialized(_this));_this.renderEditView=_this.renderEditView.bind(_assertThisInitialized(_this));_this.renderDefaultView=_this.renderDefaultView.bind(_assertThisInitialized(_this));_this.updateComponentValue=_this.updateComponentValue.bind(_assertThisInitialized(_this));return _this;}_createClass(Comment,[{key:\"changeEditMode\",value:function changeEditMode(){this.setState({isInEditMode:!this.state.isInEditMode});}},{key:\"renderEditView\",value:function renderEditView(){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",defaultValue:this.state.text//ref=\"theTextInput\" \n,ref:this.selfRef,onKeyPress:this.updateComponentValue})});}},{key:\"renderDefaultView\",value:function renderDefaultView(){return/*#__PURE__*/_jsx(\"div\",{onDoubleClick:this.changeEditMode,children:this.state.text});}},{key:\"render\",value:function render(){return this.state.isInEditMode?this.renderEditView():this.renderDefaultView();}}]);return Comment;}(Component);export default Comment;","map":{"version":3,"names":["db","relativeTimeRounding","React","Component","createRef","collection","doc","addDoc","getDoc","setDoc","updateDoc","deleteDoc","v4","Comment","props","updateComponentValue","e","commentsCollectionRef","commentRef","state","id","initialValue","text","newValue","selfRef","current","value","key","addComment","setState","removeComment","isInEditMode","recipeId","changeEditMode","bind","renderEditView","renderDefaultView"],"sources":["/home/silvere/Desktop/Apps/recipelist/src/editable.js"],"sourcesContent":["import { db } from \"./firebase.config\"\nimport { relativeTimeRounding } from 'moment';\nimport React, { Component, createRef } from 'react';\nimport {collection, doc, addDoc, getDoc, setDoc, updateDoc, deleteDoc} from \"firebase/firestore\"\nimport { v4 } from 'uuid';\n\nclass Comment extends Component {\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n        id:this.props.id,\n        text:this.props.text,\n        recipeId:this.props.recipeId,\n        isInEditMode:false, \n        addComment:this.props.addComment,\n        removeComment:this.props.removeComment\n      }\n\n    this.selfRef = React.createRef()\n\n\n    this.changeEditMode = this.changeEditMode.bind(this)\n    this.renderEditView = this.renderEditView.bind(this)\n    this.renderDefaultView = this.renderDefaultView.bind(this)\n    this.updateComponentValue = this.updateComponentValue.bind(this)\n  \n}\n\n\nchangeEditMode() {\n  this.setState(\n    {\n      isInEditMode:!this.state.isInEditMode\n    }\n  )\n}\n\n\n\nupdateComponentValue = async (e) => {\n  const commentsCollectionRef = collection(db,\"comments\")\n  const commentRef = doc(db,\"comments\",this.state.id)\n  const initialValue = this.state.text\n  //const newValue = this.refs.theTextInput.value\n  const newValue = this.selfRef.current.value\n\n  if (e.key === \"Enter\") {\n    if (initialValue === \"############################################################\") {\n      if (newValue !== initialValue && newValue !==\"\") {\n        this.state.addComment(newValue)\n        //var x = v4();\n        //const timestamp = Date.now()\n        //await setDoc(doc(db, \"comments\", x),{recipeId:this.state.recipeId,text:newValue,timestamp:timestamp})\n      }\n    } \n    else {\n      if (newValue !== \"\") {\n        this.setState({text:newValue})\n        await updateDoc(doc(db, \"comments\", this.state.id),{text:newValue})\n      } else {\n        this.state.removeComment(this.state.id)\n        //await deleteDoc(doc(db,\"comments\",this.state.id))\n      }\n      }\n    this.setState({\n    isInEditMode:false\n  })\n    \n  }\n}\n\n\nrenderEditView() {\n  return <div>\n    <input type=\"text\" \n           defaultValue={this.state.text}\n           //ref=\"theTextInput\" \n           ref = {this.selfRef} onKeyPress={this.updateComponentValue}/>\n  </div>\n}\n\nrenderDefaultView() {\n  return <div onDoubleClick = {this.changeEditMode}> \n  {this.state.text}\n</div>\n}\n\n  render() {\n    return this.state.isInEditMode ? \n     this.renderEditView() : this.renderDefaultView()\n    \n  }\n}\n\nexport default Comment;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}